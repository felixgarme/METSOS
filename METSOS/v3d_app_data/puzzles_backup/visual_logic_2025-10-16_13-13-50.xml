<xml xmlns="http://www.w3.org/1999/xhtml">
  <tab name="Init" type="InitTab" active="false" scrollx="345.25" scrolly="0" scale="0.9"></tab>
  <tab name="New Tab" type="CommonTab" active="true" scrollx="345.2500000000002" scrolly="20.250000000000114" scale="0.9">
    <block xmlns="https://developers.google.com/blockly/xml" type="connectorSlot" id="-iJ-sL6.kR)?;Mpp(@2j" x="-315" y="324">
      <statement name="DO">
        <block type="execScript" id="#kQNJYlTDnyY..(9!!Nn">
          <value name="TEXT">
            <shadow type="textMultiline" id="wf%u4x(BiO0H_{79BMS1">
              <field name="HIGHLIGHT_MODE">javascript</field>
              <field name="TEXT" editor-height="4" editor-width="475">window.app = app; &amp;#10;import("./imports.js");&amp;#10;</field>
            </shadow>
          </value>
          <next>
            <block type="execScript" id="VDn)UCT=1L`e,t*l|,2i">
              <value name="TEXT">
                <shadow type="textMultiline" id="?l4;BwT|/}:ZR+X!B)+D">
                  <field name="HIGHLIGHT_MODE">javascript</field>
                  <field name="TEXT" editor-height="4" editor-width="475">// Ejecuta en el contexto de Verge3D (p.ej. exec script puzzle)&amp;#10;// Asegúrate de tener BufferGeometryUtils (three/examples/jsm/utils/BufferGeometryUtils.js)&amp;#10;// En Verge3D normalmente three.js ya está disponible como window.THREE&amp;#10;&amp;#10;(function() {&amp;#10;  const { BufferGeometryUtils, Matrix4 } = THREE; // Verge3D expone THREE&amp;#10;  const parent = app.scene.getObjectByName("GroupToMerge"); // o busca tus objetos&amp;#10;  const meshes = [];&amp;#10;  parent.traverse(obj =&gt; {&amp;#10;    if (obj.isMesh &amp;&amp; obj.material &amp;&amp; obj.material.userData.mergeable !== false) {&amp;#10;      // opcional: filtrar por material&amp;#10;      meshes.push(obj);&amp;#10;    }&amp;#10;  });&amp;#10;&amp;#10;  // Agrupar por material para poder fusionar sólo las que comparten material&amp;#10;  const byMaterial = {};&amp;#10;  meshes.forEach(m =&gt; {&amp;#10;    const key = m.material.uuid;&amp;#10;    byMaterial[key] = byMaterial[key] || [];&amp;#10;    // aplicar transform a geometría&amp;#10;    const geom = m.geometry.clone();&amp;#10;    geom.applyMatrix4(m.matrixWorld);&amp;#10;    byMaterial[key].push(geom);&amp;#10;    // opcional: esconder el mesh original&amp;#10;    m.visible = false;&amp;#10;  });&amp;#10;&amp;#10;  Object.values(byMaterial).forEach((geoms, i) =&gt; {&amp;#10;    if (geoms.length === 0) return;&amp;#10;    const merged = BufferGeometryUtils.mergeBufferGeometries(geoms, true);&amp;#10;    const newMesh = new THREE.Mesh(merged, meshes[i].material);&amp;#10;    newMesh.name = "MergedMesh_" + i;&amp;#10;    app.scene.add(newMesh);&amp;#10;  });&amp;#10;&amp;#10;})();&amp;#10;</field>
                </shadow>
              </value>
              <next>
                <block type="tweenCameraExt" id="+bi}Hb@I(}aHx081=C8O">
                  <mutation xmlns="http://www.w3.org/1999/xhtml" whenfinishedslot="false"></mutation>
                  <field name="MOVEMENT_TYPE">LINEAR</field>
                  <value name="POSITION">
                    <block type="objectList" id="v~FE?O/ooe$h^4KAwg#S">
                      <field name="FIELDNAME">Cube</field>
                    </block>
                  </value>
                  <value name="LOOKAT">
                    <block type="objectList" id="9+Jq=^7tP;ruIs3@BP#K">
                      <field name="FIELDNAME">Cube</field>
                    </block>
                  </value>
                  <value name="DURATION">
                    <shadow type="math_number" id="Av{.kK6#_#_Q`KqxBp#C">
                      <field name="NUM">1</field>
                    </shadow>
                  </value>
                  <next>
                    <block type="addFog" id="FVk}t5;mlBJQDQfIR^[s" disabled="true">
                      <value name="R">
                        <shadow type="math_number" id="Hfe~cSLgc?o?LK;af#K5">
                          <field name="NUM">185</field>
                        </shadow>
                      </value>
                      <value name="G">
                        <shadow type="math_number" id="[6Uv].E.F)pZ!UIv)vjy">
                          <field name="NUM">200</field>
                        </shadow>
                      </value>
                      <value name="B">
                        <shadow type="math_number" id="~S@^1^yC~%njxx7:#D6r">
                          <field name="NUM">215</field>
                        </shadow>
                      </value>
                      <value name="DENSITY">
                        <shadow type="math_number" id="cyf4{)X0W$:R98W|nb5{">
                          <field name="NUM">0.00075</field>
                        </shadow>
                      </value>
                    </block>
                  </next>
                </block>
              </next>
            </block>
          </next>
        </block>
      </statement>
    </block>
  </tab>
  <editorsettings viewport-x="1180.1999999999998" viewport-y="37" viewport-w="798.8" viewport-h="448.5" viewport-hidden="false" toolbox-library-mode="false" toolbox-minimized-mode="false"></editorsettings>
</xml>